import{b as T,d as f,f as j,g as A,h as P,j as v,l as U,n as V,o as x,q as B,r as D,s as L,v as _,w as q,x as O,y as Y}from"./chunk-4NJECB4M.js";import{S as C,U as w,V as k,X as N}from"./chunk-ANF2UDXZ.js";import{g as y,i as b,n as c,o as R,q as I,r as E,w as G}from"./chunk-UHN6TUEN.js";import"./chunk-6DNEPBLD.js";import{Ab as d,Hc as F,Jb as s,Kb as o,Lb as p,Ub as S,dc as m,eb as u,fb as t,lc as M,pa as g}from"./chunk-74Y5P3YM.js";var pe=(()=>{let r=class r{constructor(e,i,a,h,z,H){this.authService=e,this.toastr=i,this.router=a,this.tokenService=h,this.userService=z,this.route=H,this.loginForm=new P({username:new v("",{validators:[f.required]}),password:new v("",{validators:[f.required]})}),this.route.queryParams.subscribe(n=>{this.loginForm.controls.username.patchValue(n.username),this.loginForm.controls.password.patchValue(n.uuid)}),F(()=>{let n=this.userService.user();if(n?.role){let J=this.getRouteByRole(n.role);this.router.navigate([J]),this.toastr.success("Login erfolgreich","Erfolgreich")}})}authenticate(){this.authService.authenticate(this.loginForm.getRawValue()).subscribe({next:e=>{this.tokenService.storeToken(e.token),this.userService.loginUser()},error:()=>{this.toastr.error("Username/Passwort falsch","Fehler")}})}getRouteByRole(e){switch(e){case c.ADMIN:return"/racing/onboarding";case c.USER:return"/racing/race";case c.EMPLOYEE:return"/racing/penalty";default:return"/"}}};r.\u0275fac=function(i){return new(i||r)(t(E),t(G),t(b),t(R),t(I),t(y))},r.\u0275cmp=g({type:r,selectors:[["app-login"]],standalone:!0,features:[M],decls:13,vars:2,consts:[["appearance","outlined"],[3,"formGroup"],["formControlName","username","id","username","matInput",""],["type","password","formControlName","password","id","password","matInput",""],["mat-flat-button","","type","submit",3,"click","disabled"]],template:function(i,a){i&1&&(s(0,"mat-card",0)(1,"mat-card-content")(2,"form",1)(3,"mat-form-field")(4,"mat-label"),m(5,"Username"),o(),p(6,"input",2),o(),s(7,"mat-form-field")(8,"mat-label"),m(9,"Passwort"),o(),p(10,"input",3),o(),s(11,"button",4),S("click",function(){return a.authenticate()}),m(12," Login "),o()()()()),i&2&&(u(2),d("formGroup",a.loginForm),u(9),d("disabled",!a.loginForm.valid))},dependencies:[B,U,T,j,A,w,C,q,_,L,Y,O,D,V,x,k,N],styles:["[_nghost-%COMP%]{--mdc-outlined-card-container-color: var(--app-secondary)}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]});let l=r;return l})();export{pe as LoginComponent};
