import{a as H,b as _}from"./chunk-IVZKHT6F.js";import{a as I,c as w}from"./chunk-5YRAG2Q4.js";import{a as B}from"./chunk-DFXQRXQG.js";import{a as O,d as V,e as G,f as q,g as Y}from"./chunk-EKAMS23F.js";import{S as R,U as C,V as k,Y as N,_ as p,aa as j,ba as A,ca as U,ea as d,fa as x,ha as D,ia as L,ja as P,ka as T}from"./chunk-EDQHVCWM.js";import{a as y}from"./chunk-RYNRYX7J.js";import"./chunk-AESYL7IM.js";import{Fb as b,Ob as c,Tb as F,U as h,Wa as M,Xa as o,_ as v,da as g,ja as S,nb as u,tc as E,wb as m,xb as n,yb as l}from"./chunk-J5KHPRBR.js";var z=(()=>{let e=class e{constructor(t){this.http=t}authenticate(t){return this.http.post(k+"authenticate",t)}};e.\u0275fac=function(i){return new(i||e)(g(y))},e.\u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var s=function(r){return r.ADMIN="ADMIN",r.USER="USER",r.EMPLOYEE="EMPLOYEE",r}(s||{});var Ft=(()=>{let e=class e{constructor(t,i,a,f,J,K){this.authService=t,this.toastr=i,this.router=a,this.tokenService=f,this.userService=J,this.route=K,this.loginForm=new U({username:new d("",{validators:[p.required]}),password:new d("",{validators:[p.required]})})}ngOnInit(){this.route.queryParams.subscribe(t=>{this.loginForm.controls.username.patchValue(t.username),this.loginForm.controls.password.patchValue(t.uuid)})}ngOnDestroy(){this.sub?.unsubscribe()}authenticate(){this.sub=this.authService.authenticate(this.loginForm.getRawValue()).pipe(h(t=>(this.tokenService.storeToken(t.token),this.userService.loginUser(),this.userService.user))).subscribe({next:t=>{if(t?.role){let i=this.getRouteByRole(t?.role);console.log(i),this.router.navigate([i]),this.toastr.success("Login erfolgreich","Erfolgreich")}},error:()=>{this.toastr.error("Username/Passwort falsch","Fehler")}})}getRouteByRole(t){switch(t){case s.ADMIN:return"/onboarding";case s.USER:return"/race";case s.EMPLOYEE:return"/penalty";default:return"/"}}};e.\u0275fac=function(i){return new(i||e)(o(z),o(B),o(w),o(H),o(_),o(I))},e.\u0275cmp=S({type:e,selectors:[["app-login"]],standalone:!0,features:[F],decls:12,vars:2,consts:[[3,"formGroup"],[1,"form-container"],["formControlName","username","id","username","matInput",""],["type","password","formControlName","password","id","password","matInput",""],["color","primary","mat-raised-button","","type","submit",3,"click","disabled"]],template:function(i,a){i&1&&(m(0,"form",0)(1,"div",1)(2,"mat-form-field")(3,"mat-label"),c(4,"Username"),n(),l(5,"input",2),n(),m(6,"mat-form-field")(7,"mat-label"),c(8,"Passwort"),n(),l(9,"input",3),n(),m(10,"button",4),b("click",function(){return a.authenticate()}),c(11," Login "),n()()()),i&2&&(u("formGroup",a.loginForm),M(10),u("disabled",!a.loginForm.valid))},dependencies:[E,P,x,N,j,A,C,R,G,V,O,Y,q,T,D,L],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#fdf1cd;padding:15px}"]});let r=e;return r})();export{Ft as LoginComponent};
