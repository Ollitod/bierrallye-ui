import{b as T,d as p,f as U,g as A,h as P,j as f,k as V,m as x,n as B,p as G,q as L,r as q,u as O,v as Y,w as z,x as H}from"./chunk-NBEWA5WN.js";import{T as w,V as C,W as N,Y as j}from"./chunk-VOET7OD3.js";import{g as R,i as b,n as m,o as I,q as k,s as E,t as D,x as _}from"./chunk-XRKOCIBS.js";import"./chunk-LTZWD7ZI.js";import{Ha as M,Ib as n,Jb as o,Kb as d,Tb as y,Z as g,cc as s,eb as l,fb as r,hc as F,pa as S,zb as u}from"./chunk-ODBFWMRA.js";var he=(()=>{let i=class i{constructor(e,t,a,h,J,K,Q){this.authService=e,this.toastr=t,this.router=a,this.tokenService=h,this.userService=J,this.route=K,this.destroyRef=Q,this.loginForm=new P({username:new f("",{validators:[p.required]}),password:new f("",{validators:[p.required]})}),this.route.queryParams.subscribe(v=>{this.loginForm.controls.username.patchValue(v.username),this.loginForm.controls.password.patchValue(v.uuid)})}authenticate(){this.authService.authenticate(this.loginForm.getRawValue()).pipe(k(this.destroyRef),g(e=>(this.tokenService.storeToken(e.token),this.userService.loginUser(),this.userService.user))).subscribe({next:e=>{if(e?.role){let t=this.getRouteByRole(e?.role);this.router.navigate([t]),this.toastr.success("Login erfolgreich","Erfolgreich")}},error:()=>{this.toastr.error("Username/Passwort falsch","Fehler")}})}getRouteByRole(e){switch(e){case m.ADMIN:return"/racing/onboarding";case m.USER:return"/racing/race";case m.EMPLOYEE:return"/racing/penalty";default:return"/"}}};i.\u0275fac=function(t){return new(t||i)(r(D),r(_),r(b),r(I),r(E),r(R),r(M))},i.\u0275cmp=S({type:i,selectors:[["app-login"]],standalone:!0,features:[F],decls:13,vars:2,consts:[["appearance","outlined"],[3,"formGroup"],["formControlName","username","id","username","matInput",""],["type","password","formControlName","password","id","password","matInput",""],["mat-flat-button","","type","submit",3,"click","disabled"]],template:function(t,a){t&1&&(n(0,"mat-card",0)(1,"mat-card-content")(2,"form",1)(3,"mat-form-field")(4,"mat-label"),s(5,"Username"),o(),d(6,"input",2),o(),n(7,"mat-form-field")(8,"mat-label"),s(9,"Passwort"),o(),d(10,"input",3),o(),n(11,"button",4),y("click",function(){return a.authenticate()}),s(12," Login "),o()()()()),t&2&&(l(2),u("formGroup",a.loginForm),l(9),u("disabled",!a.loginForm.valid))},dependencies:[G,V,T,U,A,C,w,Y,O,q,H,z,L,x,B,N,j],styles:["[_nghost-%COMP%]{--mdc-outlined-card-container-color: var(--app-secondary)}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]});let c=i;return c})();export{he as LoginComponent};
